{"version":3,"sources":["webpack://exports/webpack/bootstrap","webpack://exports/./src/symboltree.js","webpack://exports/external \"sketch/dom\"","webpack://exports/external \"sketch/settings\"","webpack://exports/external \"sketch/ui\""],"names":["console","log","Text","require","Style","Document","Group","UI","ShapePath","Settings","document","getSelectedDocument","page","selectedPage","labelGroupName","treeGroupName","depthMargin","margin","gray","_time","Date","now","labelGroup","treeGroup","lastX","lastY","maxY","labelStyle","fontSize","textColor","alignment","fontFamily","fontWeight","labels","names","symbols","findPageLayerNamed","collectSymbolMastersInPage","onSyncSymbolTree","timestamp","getStoredSymbolMasterNames","renameSymbolsByPosition","arrangeSymbols","setStoredSymbolMasterNames","error","alert","message","resetStoredSymbolMasterNames","removeTree","removeLabels","found","getLayersNamed","forEach","element","remove","setDocumentSettingForKey","length","symbol","id","name","documentSettingForKey","map","newMap","parent","_object","setHasClickThrough","locked","sort","sortByName","i","mapLayerByName","arrangeLayersByMap","_LAYERS","layer","tokens","split","mapThis","undefined","push","mapLevel","depth","previousSibling","parentLabel","label","addLabel","layers","lf","frame","x","y","Math","max","height","width","key","text","textObj","style","p","ps","x0","y0","x1","y1","shapePath","fromSVGPath","borders","color","fillType","FillType","Color","borderOptions","endArrowhead","cnt","adjustToFit","slice","masterList","concat","setRulerBase","CGPointMake","sortLayersByOffsetY","lastLabelDepth","pathStack","path","l","type","round","token","charAt","isNewOrRenamed","join","newName","calculateNewName","oldName","newPath","context","showMessage","a","b","localeCompare","t","warn"],"mappings":"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","file":"symboltree.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./src/symboltree.js\");\n","console.log(\"+++\");\nconst Text = require('sketch/dom').Text;\nconst Style = require('sketch/dom').Style;\nconst Document = require('sketch/dom').Document;\nconst Group = require('sketch/dom').Group;\nconst UI = require('sketch/ui');\nconst ShapePath = require('sketch/dom').ShapePath;\nconst Settings = require('sketch/settings')\n\nconst document = Document.getSelectedDocument();\nconst page = document.selectedPage;\n\n//Settings\nconst labelGroupName = \"#LABELS\";\nconst treeGroupName = \"#TREE\";\nconst depthMargin = 50;\nconst margin = 50;\nconst gray = '#777777';\n\nvar _time = Date.now();\n\nvar labelGroup = false;\nvar treeGroup = false;\n\nvar lastX = 0;\nvar lastY = 0;\nvar maxY = 0;\n\nconst labelStyle = {\n\tfontSize: 20,\n\ttextColor: gray,\n\talignment: \"left\",\n\tfontFamily: 'Monaco',\n\tfontWeight: 5\n}\n\nvar labels = false;\nvar names = false;\nvar symbols = false;\n\ntreeGroup = findPageLayerNamed(treeGroupName);\nlabelGroup = findPageLayerNamed(labelGroupName);\nsymbols = collectSymbolMastersInPage();\n\n//// #SYNC\nexport function onSyncSymbolTree() {\n\ttry {\n\t\ttimestamp(\"+++ start sync +++\");\n\t\tif (labelGroup) {\n\t\t\t//if labels exist, rename symbol masters based on labeling\n\t\t\tgetStoredSymbolMasterNames();\n\t\t\trenameSymbolsByPosition();\n\t\t}\n\t\t//generate new labels and sort symbols\n\t\tarrangeSymbols();\n\t\tsetStoredSymbolMasterNames();\n\t} catch (error) {\n\t\tconsole.error(error);\n\t\tUI.alert('SymbolTree Just Messed It Up!!!', error.message + ' > Clearing everything out and starting fresh.');\n\t\t//recover from error. Remove all labels to avoid renaming mishaps ;)\n\t\tresetStoredSymbolMasterNames();\n\t\tremoveTree();\n\t\tremoveLabels();\n\t}\n}\n\nfunction removeTree() {\n\tvar found = document.getLayersNamed(treeGroupName);\n\tfound.forEach(element => {\n\t\telement.remove();\n\t})\n}\n\nfunction removeLabels() {\n\tvar found = document.getLayersNamed(labelGroupName);\n\tfound.forEach(element => {\n\t\telement.remove();\n\t});\n}\n\n// DATA ##\nfunction resetStoredSymbolMasterNames() {\n\tSettings.setDocumentSettingForKey(document, '_STSymbolNames', null);\n}\n\nfunction setStoredSymbolMasterNames() {\n\tif (symbols == null || symbols.length == 0) {\n\t\tconsole.error(\"NO SYMBOL MASTERS HERE!!\");\n\t\treturn;\n\t}\n\tnames = {};\n\tsymbols.forEach(symbol => {\n\t\tnames[symbol.id] = symbol.name;\n\t});\n\tSettings.setDocumentSettingForKey(document, '_STSymbolNames', names);\n}\n\nfunction getStoredSymbolMasterNames() {\n\tnames = Settings.documentSettingForKey(document, '_STSymbolNames');\n\tif (!names) names = {};\n}\n\n// ARRANGE ##\nfunction arrangeSymbols() {\n\n\tvar map = newMap();\n\n\tremoveLabels();\n\tremoveTree();\n\n\tlabelGroup = new Group();\n\n\tlabelGroup.name = labelGroupName;\n\t//labelGroup.adjustToFit();\n\tlabelGroup.parent = page;\n\tlabelGroup._object.setHasClickThrough(true);\n\n\ttreeGroup = new Group();\n\ttreeGroup.name = treeGroupName;\n\t//treeGroup.adjustToFit();\n\ttreeGroup.parent = page;\n\ttreeGroup._object.setHasClickThrough(true);\n\ttreeGroup.locked = true;\n\n\tsymbols.sort(sortByName);\n\n\tvar map = newMap();\n\n\tfor (var i = 0; i < symbols.length; i++) {\n\t\tmapLayerByName(symbols[i], map);\n\t}\n\n\ttimestamp(\"map layers\");\n\tarrangeLayersByMap(\"\", map, 0, null, null);\n\ttimestamp(\"arrange layers\");\n\tmessage('Arranged ' + symbols.length + ' symbols. Done!');\n\n}\n\nfunction newMap() {\n\treturn {\n\t\t_LAYERS: []\n\t};\n}\n\nfunction mapLayerByName(layer, map) {\n\tconst tokens = layer.name.split(\"/\");\n\tvar mapThis = map;\n\tfor (var i = 0; i < tokens.length - 1; i++) {\n\t\tif (mapThis[tokens[i]] == undefined) mapThis[tokens[i]] = newMap();\n\t\tmapThis = mapThis[tokens[i]];\n\t}\n\tmapThis._LAYERS.push(layer);\n}\n\n\n/*\nvar fiber = require('sketch/async').createFiber()\nlongRunningTask(function(err, result) {\n  fiber.cleanup()\n  // you can continue working synchronously here\n})\n*/\n\n\n\nfunction arrangeLayersByMap(name, mapLevel, depth, previousSibling, parentLabel) { //RECURSIVE!!\n\n\tlastX = depth * depthMargin;\n\tlastY = maxY + margin;\n\tconst label = addLabel(name, name, lastX, lastY, previousSibling, parentLabel);\n\tlastY += depthMargin;\n\tmaxY += depthMargin;\n\n\tconst layers = mapLevel._LAYERS;\n\tfor (var i = 0; i < layers.length; i++) {\n\t\tconst lf = layers[i].frame;\n\t\tlayers[i].frame = {\n\t\t\tx: lastX,\n\t\t\ty: lastY\n\t\t};\n\t\tmaxY = Math.max(maxY, lastY + lf.height);\n\t\tlastX = lastX + margin + lf.width;\n\t}\n\n\tpreviousSibling = label;\n\tfor (var key in mapLevel) {\n\t\tif (key != \"_LAYERS\") {\n\t\t\tpreviousSibling = arrangeLayersByMap(key, mapLevel[key], depth + 1, previousSibling, label);\n\t\t}\n\t}\n\n\treturn label;\n}\n\nfunction addLabel(text, id, x, y, previousSibling, parentLabel) {\n\tvar textObj = new Text({\n\t\ttext: text + \"/\",\n\t\tname: text,\n\t\tframe: {\n\t\t\tx: x,\n\t\t\ty: y\n\t\t},\n\t\tstyle: labelStyle,\n\t\tparent: labelGroup\n\t});\n\n\tif (parentLabel) {\n\t\tconst p = parentLabel.frame;\n\t\tconst ps = (previousSibling) ? previousSibling.frame : p;\n\n\t\tvar x0 = p.x - 20;\n\t\tvar y0 = ps.y + 15;\n\t\tvar x1 = x - 20;\n\t\tvar y1 = y + 15;\n\n\t\tconst shapePath = ShapePath.fromSVGPath(\n\t\t\t'M' + x0 + ' ' + y0 +\n\t\t\t' ' + ' L ' + x0 + ' ' + (y1 - 10) +\n\t\t\t'Q' + x0 + ' ' + y1 + ' ' + (x0 + 10) + ' ' + (y1) +\n\t\t\t' ' + ' L ' + x1 + ' ' + y1);\n\n\t\tshapePath.style = {\n\t\t\tborders: [{\n\t\t\t\tcolor: gray,\n\t\t\t\tfillType: Style.FillType.Color\n\t\t\t}],\n\t\t\tborderOptions: {\n\t\t\t\tendArrowhead: \"FilledCircle\",\n\t\t\t}\n\t\t};\n\n\t\tshapePath.parent = treeGroup;\n\t}\n\n\treturn textObj;\n}\n\nfunction renameSymbolsByPosition() {\n\ttimestamp(\"+++ start rename ✏️\");\n\n\tvar cnt = 0;\n\n\tlabelGroup.adjustToFit();\n\tlabels = labelGroup.layers.slice();\n\tvar masterList = [];\n\t//sort by Y\n\tmasterList = symbols.concat(labels);\n\tpage._object.setRulerBase(CGPointMake(0, 0));\n\tmasterList.sort(sortLayersByOffsetY);\n\n\ttimestamp(\"sort master list\");\n\n\tvar lastLabelDepth = 0;\n\tvar pathStack = ['/'];\n\tvar depth = 0;\n\tvar path = '/';\n\n\tfor (var i = 0; i < masterList.length; i++) {\n\t\tconst l = masterList[i];\n\t\tconst type = l.type;\n\t\tif (type == \"Text\") {\n\t\t\t//is a label\n\n\t\t\tdepth = Math.round(l.frame.x / depthMargin);\n\t\t\tif (depth > lastLabelDepth) { //correct for overly deep label placement\n\t\t\t\tdepth = lastLabelDepth + 1;\n\t\t\t}\n\n\t\t\tvar token = l.text;\n\t\t\ttoken = (token.charAt(token.length - 1) == \"/\") ? token : token + \"/\";\n\t\t\tpathStack[depth] = token;\n\t\t\tlastLabelDepth = depth;\n\t\t} else if (type == \"SymbolMaster\" && !isNewOrRenamed(l)) {\n\t\t\tpath = pathStack.slice(1, depth + 1).join(\"\");\n\t\t\tvar newName = calculateNewName(l.name, path);\n\t\t\tif (l.name != newName) {\n\t\t\t\tl.name = newName;\n\t\t\t\tcnt++;\n\t\t\t}\n\t\t} //ELSE ignore\n\t}\n\ttimestamp(\"rename\");\n\tmessage('✏️ Renamed ' + cnt + ' symbols.');\n}\n\n//// UTIL\n\nfunction calculateNewName(oldName, newPath) {\n\tvar tokens = oldName.split(\"/\");\n\tvar name = tokens[tokens.length - 1];\n\treturn newPath + name;\n}\n\nfunction isNewOrRenamed(symbol) {\n\treturn names[symbol.id] != symbol.name;\n}\n\nfunction message(text) {\n\tconsole.log(\"<\" + text + \">\");\n\tcontext.document.showMessage(text);\n}\n\nfunction collectSymbolMastersInPage() {\n\tvar symbols = [];\n\tvar layers = page.layers;\n\tfor (var i = 0; i < layers.length; i++) {\n\t\tif (layers[i].type == \"SymbolMaster\") {\n\t\t\tsymbols.push(layers[i]);\n\t\t}\n\t}\n\treturn symbols;\n}\n\nfunction findPageLayerNamed(name) { // Finds layers on the page (not inside Artboards or SymbolMasters)\n\tvar layers = document.getLayersNamed(name);\n\tfor (var i = 0; i < layers.length; i++) {\n\t\tif (layers[i].parent.id == page.id) return layers[i];\n\t}\n\treturn false;\n}\n\nfunction sortByName(a, b) {\n\treturn a.name.localeCompare(b.name);\n}\n\nfunction sortLayersByOffsetY(a, b) {\n\treturn (a.frame.y + a.parent.frame.y) - (b.frame.y + b.parent.frame.y);\n}\n\nfunction timestamp(label) {\n\tvar t = ((Date.now() - _time) / 1000);\n\t/*if(t > .1)*/\n\tconsole.warn(label + \" - \" + t + \" sec.\")\n\t_time = Date.now();\n}","module.exports = require(\"sketch/dom\");","module.exports = require(\"sketch/settings\");","module.exports = require(\"sketch/ui\");"],"sourceRoot":""}