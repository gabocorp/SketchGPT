{"version":3,"sources":["webpack://exports/webpack/bootstrap","webpack://exports/./src/symboltree.js","webpack://exports/external \"sketch/dom\"","webpack://exports/external \"sketch/settings\"","webpack://exports/external \"sketch/ui\""],"names":["console","log","Text","require","Style","Document","Group","UI","ShapePath","Settings","document","getSelectedDocument","page","selectedPage","_time","Date","now","debug","labelGroupName","treeGroupName","depthMargin","margin","labelGroup","treeGroup","lastX","lastY","maxY","labelStyle","fontSize","textColor","alignment","fontFamily","fontWeight","labels","names","symbols","findFirstLayerNamed","collectSymbols","onSyncSymbolTree","timestamp","getPreviousSymbolNames","onRenameSymbolsByLocation","onArrangeSymbols","storeCurrentNames","error","alert","message","resetStoredNames","removeTree","removeLabels","replaceContainerNamed","name","found","getLayersNamed","forEach","element","remove","parent","setDocumentSettingForKey","length","symbol","id","documentSettingForKey","map","newMap","adjustToFit","_object","setHasClickThrough","locked","sort","sortSymbolsByName","i","mapLayerByName","arrangeLayersByMap","_LAYERS","layer","tokens","split","mapThis","undefined","push","mapLevel","depth","previousSibling","parentLabel","label","addLabel","l","frame","x","y","maxYn","height","Math","max","width","key","text","textObj","style","p","ps","x0","y0","x1","y1","shapePath","fromSVGPath","borders","color","fillType","FillType","Color","borderOptions","endArrowhead","cnt","layers","slice","masterList","concat","setRulerBase","CGPointMake","sortLayersByOffsetY","lastLabelDepth","pathStack","path","type","round","token","charAt","wasRenamed","join","newName","calculateNewName","oldName","newPath","context","showMessage","ss","getSymbols","a","b","match","ax","bx","replace","_","$1","$2","$3","Infinity","an","shift","bn","nn","localeCompare","t","warn"],"mappings":"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","file":"symboltree.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./src/symboltree.js\");\n","console.log(\"+++\");\n//const Page = require('sketch/dom').Page;\nconst Text = require('sketch/dom').Text;\nconst Style = require('sketch/dom').Style;\nconst Document = require('sketch/dom').Document;\nconst Group = require('sketch/dom').Group;\nconst UI = require('sketch/ui');\nconst ShapePath = require('sketch/dom').ShapePath;\nconst Settings = require('sketch/settings')\n\nconst document = Document.getSelectedDocument();\nconst page = document.selectedPage;\n\nvar _time = Date.now();\n\nconst debug = true;\n\n//Settings\nconst labelGroupName = \"#LABELS\";\nconst treeGroupName = \"#TREE\";\n\nconst depthMargin = 50;\nconst margin = 50;\n\nvar labelGroup = false;\nvar treeGroup = false;\n\nvar lastX = 0;\nvar lastY = 0;\nvar maxY = 0;\n\nconst labelStyle = {\n\t\tfontSize:20,\n\t\ttextColor:\"#777777FF\",\n\t\talignment:\"left\",\n\t\tfontFamily:'Monaco',\n\t\tfontWeight:5\n}\n\nvar labels = false;\nvar names = false;\n\nvar symbols = false;\n\ntreeGroup = findFirstLayerNamed(treeGroupName);\nlabelGroup = findFirstLayerNamed(labelGroupName);\nsymbols = collectSymbols();\n\n//// #SYNC\nexport function onSyncSymbolTree() {\n\ttry {\n\t\ttimestamp(\"+++ start sync +++\");\n\t\tif ( labelGroup ) {\n\t\t\t//if labels exist, rename symbol masters based on labeling\n\t\t\tgetPreviousSymbolNames();\n\t\t\tonRenameSymbolsByLocation();\t\n\t\t}\n\t\t//generate new labels and sort symbols\n\t\tonArrangeSymbols();\n\t\tstoreCurrentNames();\n\t} catch (error) {\n\t\tconsole.error(error);\n\t\tUI.alert('SymbolTree Just Messed It Up!!!', error.message + ' > Clearing everything out and starting fresh.');\n\t\t//recover from error. Remove all labels to avoid renaming mishaps ;)\n\t\tresetStoredNames();\n\t\tremoveTree();\n\t\tremoveLabels();\n\t}\n}\n\nfunction replaceContainerNamed( name ){\n\tvar found = document.getLayersNamed(name);\n\tfound.forEach(element => {\n\t\telement.remove();\n\t});\n\treturn new Group( {name:name,parent:page} );\n}\n\nfunction removeTree() {\n\tvar found = document.getLayersNamed(treeGroupName);\n\tfound.forEach(element => {\n\t\telement.remove();\n\t})\n}\n\nfunction removeLabels() {\n\tvar found = document.getLayersNamed(labelGroupName);\n\tfound.forEach(element => {\n\t\telement.remove();\n\t});\n}\n\nfunction resetStoredNames() {\n\tSettings.setDocumentSettingForKey(document, '_STSymbolNames', null);\n}\n\nfunction storeCurrentNames() {\n\tif (symbols == null || symbols.length == 0) {\n\t\tconsole.error(\"NO SYMBOL MASTERS HERE!!\");\n\t\treturn;\n\t}\n\tnames = {};\n\tsymbols.forEach(symbol => {\n\t\tnames[symbol.id] = symbol.name;\n\t});\n\tSettings.setDocumentSettingForKey(document, '_STSymbolNames', names);\n}\n\nfunction getPreviousSymbolNames() {\n\tnames = Settings.documentSettingForKey(document, '_STSymbolNames');\n\tif(!names) names = {};\n}\n\n// ARRANGE \nfunction onArrangeSymbols() {\n\t\n\ttimestamp(\"store symbol names\");\n\n\tvar map = newMap();\n\ttimestamp(\"+++ start arrange 📎\");\n\n\tremoveLabels();\n\tremoveTree();\n\n\tlabelGroup = new Group();\n\n\tlabelGroup.name = labelGroupName;\n\tlabelGroup.adjustToFit();\n\tlabelGroup.parent = page;\n\tlabelGroup._object.setHasClickThrough(true);\n\n\n\ttreeGroup = new Group();\n\ttreeGroup.name = treeGroupName;\n\ttreeGroup.adjustToFit();\n\ttreeGroup.parent = page;\n\ttreeGroup._object.setHasClickThrough(true);\n\ttreeGroup.locked = true;\n\n\ttimestamp(\"reset titles\");\n\t\n\ttimestamp(\"collect symbols\");\n\n\tsymbols.sort(sortSymbolsByName);\n\n\tvar map = newMap();\n\n\tfor (var i = 0; i < symbols.length; i++) {\n\t\tmapLayerByName(symbols[i], map);\n\t}\n\ttimestamp(\"map layers\");\n\n\tarrangeLayersByMap(\"\", map, 0, null, null);\n\ttimestamp(\"arrange layers\");\n\n\tmessage('Arranged ' + symbols.length + ' symbols. Done!');\n\n}\n\nfunction newMap() {\n\treturn {\n\t\t_LAYERS: []\n\t};\n}\n\nfunction mapLayerByName(layer, map) {\n\tconst tokens = layer.name.split(\"/\");\n\tvar mapThis = map;\n\tfor (var i = 0; i < tokens.length - 1; i++) {\n\t\tif (mapThis[tokens[i]] == undefined) mapThis[tokens[i]] = newMap();\n\t\tmapThis = mapThis[tokens[i]];\n\t}\n\tmapThis._LAYERS.push(layer);\n}\n\nfunction arrangeLayersByMap(name, mapLevel, depth, previousSibling, parentLabel) {\n\tlastX = depth * depthMargin;\n\tlastY = maxY + margin;\n\tconst label = addLabel(name, name, lastX, lastY, previousSibling, parentLabel);\n\tlastY += depthMargin;\n\tmaxY += depthMargin;\n\tfor (var i = 0; i < mapLevel._LAYERS.length; i++) {\n\t\t// sort through Layer content - ROW (X)\n\t\tvar l = mapLevel._LAYERS[i].frame;\n\t\tif(l.x!= lastX) l.x = lastX;\n\t\tif(l.y!= lastY) l.y = lastY;\n\t\tvar maxYn = lastY + l.height;\n\t\tmaxY = Math.max(maxY, maxYn);\n\t\tlastX = lastX + margin + l.width;\n\t}\n\tpreviousSibling = label;\n\tfor (var key in mapLevel) {\n\t\tif (key != \"_LAYERS\") {\n\t\t\tpreviousSibling = arrangeLayersByMap(key, mapLevel[key], depth + 1, previousSibling, label);\n\t\t}\n\t}\n\treturn label;\n}\n\nfunction addLabel(text, id, x, y, previousSibling, parentLabel) {\n\tvar textObj = new Text({\n\t\ttext: text + \"/\",\n\t\tname: text,\n\t\tframe:{ x:x, y:y },\n\t\tstyle:labelStyle,\n\t\tparent:labelGroup\n\n\t});\n\n\tif (parentLabel) {\n\t\tconst p = parentLabel.frame;\n\t\tconst ps = (previousSibling) ? previousSibling.frame : p;\n\n\t\tvar x0 = p.x - 20;\n\t\tvar y0 = ps.y + 15;\n\t\tvar x1 = x - 20;\n\t\tvar y1 = y + 15;\n\n\t\tconst shapePath = ShapePath.fromSVGPath(\n\t\t\t'M' + x0 + ' ' + y0 +\n\t\t\t' ' + ' L ' + x0 + ' ' + (y1 - 10) +\n\t\t\t'Q'+ x0 + ' ' + y1 + ' ' +  (x0 + 10) + ' ' + (y1) +\n\n\t\t\t//' ' + ' L ' + (x0 + 10) + ' ' + (y1) +\n\t\t\t' ' + ' L ' + x1 + ' ' + y1);\n\n\t\tshapePath.style.borders = [{\n\t\t\tcolor: '#777777',\n\t\t\tfillType: Style.FillType.Color\n\t\t}, ];\n\t\tshapePath.style.borderOptions = {\n\t\t\tendArrowhead: \"FilledCircle\",\n\t\t}\n\t\tshapePath.parent = treeGroup;\n\t}\n\n\treturn textObj;\n}\n\nfunction onRenameSymbolsByLocation() {\n\ttimestamp(\"+++ start rename ✏️\");\n\n\tvar cnt = 0;\n\t\n\tlabelGroup.adjustToFit();\n\tlabels = labelGroup.layers.slice(0);\n\tvar masterList = [];\n\t//sort by Y\n\tmasterList = symbols.concat(labels);\n\tpage._object.setRulerBase(CGPointMake(0,0));\n\tmasterList.sort( sortLayersByOffsetY );\n\n\ttimestamp(\"sort master list\");\n\n\tvar lastLabelDepth = 0;\n\tvar pathStack = ['/'];\n\tvar depth = 0;\n\tvar path = '/';\n\n\tfor( var i = 0 ; i < masterList.length ; i++ ){\n\t\tconst l = masterList[i];\n\t\tconst type = l.type;\n\t\tif(type == \"Text\"){\n\t\t\t//is a label\n\t\t\t\n\t\t\tdepth = Math.round(l.frame.x / depthMargin);\n\t\t\tif (depth > lastLabelDepth) { //correct for overly deep label placement\n\t\t\t\tdepth = lastLabelDepth + 1;\n\t\t\t}\n\n\t\t\tvar token = l.text;\n\t\t\ttoken = (token.charAt(token.length-1) == \"/\")?token:token+\"/\";\n\t\t\tpathStack[depth] = token;\n\t\t\tlastLabelDepth = depth;\n\t\t}else if(type == \"SymbolMaster\" && !wasRenamed(l) ){\n\t\t\tpath = pathStack.slice(1, depth + 1).join(\"\"); \n\t\t\tvar newName = calculateNewName( l.name , path );\n\t\t\tif( l.name != newName ) {\n\t\t\t\tl.name = newName;\n\t\t\t\tcnt++;\n\t\t\t}\n\t\t}//ELSE ignore\n\t} \n\ttimestamp(\"rename\");\n\tmessage('✏️ Renamed ' + cnt + ' symbols.');\n}\n\n//// UTIL\n\nfunction calculateNewName(oldName, newPath) {\n\tvar tokens = oldName.split(\"/\");\n\tvar name = tokens[tokens.length - 1];\n\treturn newPath + name;\n}\n\nfunction wasRenamed(symbol){\n\treturn names[symbol.id] != symbol.name;\n}\n\nfunction message(text) {\n\tlog(\"<\" + text + \">\");\n\tcontext.document.showMessage(text);\n}\n\nfunction log(text) {\n\tconsole.log(\"[g]\" + text + \"\")\n}\n\nfunction collectSymbols() {\n\tvar ss = document.getSymbols();\n\tvar symbols = [];\n\n\tfor (var i = 0; i < ss.length; i++) {\n\t\tif (ss[i].parent && ss[i].parent.id == page.id) {\n\t\t\tsymbols.push(ss[i]);\n\t\t}\n\t}\n\treturn symbols;\n}\n\nfunction findFirstLayerNamed(name) {\n\tvar layers = document.getLayersNamed(name);\n\tfor (var i = 0; i < layers.length; i++) {\n\t\tif (layers[i].parent.id == page.id) return layers[i];\n\t}\n\treturn false;\n}\n\nfunction sortSymbolsByName(a, b) {\n\tvar match = /([^a-zA-Z0-9])|([0-9]+)|([a-zA-Z]+)/g,\n\t\tax = [],\n\t\tbx = [];\n\ta.name.replace(match, function (_, $1, $2, $3) {\n\t\tax.push([$1 || \"\", $2 || Infinity, $3 || \"0\"])\n\t});\n\tb.name.replace(match, function (_, $1, $2, $3) {\n\t\tbx.push([$1 || \"\", $2 || Infinity, $3 || \"0\"])\n\t});\n\n\twhile (ax.length && bx.length) {\n\t\tvar an = ax.shift(),\n\t\t\tbn = bx.shift(),\n\t\t\tnn = an[0].localeCompare(bn[0]) || (an[1] - bn[1]) || an[2].localeCompare(bn[2]);\n\t\tif (nn) return nn;\n\t}\n\treturn ax.length - bx.length;\n}\n\nfunction sortLayersByOffsetY(a, b) {\n\treturn (a.frame.y + a.parent.frame.y) - (b.frame.y + b.parent.frame.y);\n}\n\nfunction timestamp(label) {\n\tvar t = ((Date.now() - _time) / 1000) ;\n\tif(t > .3) console.warn(label + \" - \" + t + \" sec.\")\n\t_time = Date.now();\n}","module.exports = require(\"sketch/dom\");","module.exports = require(\"sketch/settings\");","module.exports = require(\"sketch/ui\");"],"sourceRoot":""}